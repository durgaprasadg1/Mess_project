<%- layout("/layouts/boilerplate") %>

<style>
  body {
    background: #f0f2f5;
  }
  
  /* Container for the signup form */
  .signup-container {
    max-width: 500px;
    margin: 3rem auto;
    background: #fff;
    padding: 2.5rem 2rem;
    border-radius: 8px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
  }
  
  .signup-heading {
    text-align: center;
    margin-bottom: 1.5rem;
    font-size: 2rem;
    color: #f59506;
    font-weight: bold;
  }
  
  .form-control {
    border-radius: 4px;
    border: 1px solid #ced4da;
  }
  
  .btn-primary {
    background:  linear-gradient(135deg, #ff7300, #ffae00);
    border: none;
    border-radius: 4px;
    padding: 0.75rem;
    transition: background 0.3s ease, transform 0.3s ease;
  }
  
  .btn-primary:hover {
    background:  linear-gradient(135deg, #ff7300, #ffae00);
    transform: scale(1.02);
  }
  
  .link {
    text-decoration: none;
    color: #f59506;
  }
  
  .link:hover {
    text-decoration: underline;
  }
</style>

<!-- Loader with smooth fade-out -->
<div
  id="loader"
  class="d-flex justify-content-center align-items-center position-fixed top-0 start-0 vw-100 vh-100 bg-white"
  style="z-index: 9999; transition: opacity 0.5s ease;">
  <div class="spinner-grow text-primary" role="status" style="width: 4rem; height: 4rem;">
    <span class="visually-hidden">Loading...</span>
  </div>
</div>

<div class="signup-container">
  <h3 class="signup-heading">
    <i class="bi bi-person-plus-fill me-2"></i> Sign Up
  </h3>

  <form novalidate class="needs-validation" method="post" action="/signup" id="signupForm">
    <div class="mb-3">
      <label for="email" class="form-label fw-semibold">Email</label>
      <input
        required
        type="email"
        name="email"
        id="email"
        class="form-control"
        placeholder="Enter your email" />
      <div class="invalid-feedback">Please enter a valid email</div>
    </div>

    <div class="mb-3">
      <label for="phone" class="form-label fw-semibold">Phone Number</label>
      <input
        required
        type="text"
        name="phone"
        id="phone"
        class="form-control"
        placeholder="Enter your active phone number" />
      <div class="invalid-feedback">Please enter a valid phone number</div>
    </div>

    <div class="mb-3">
      <label for="username" class="form-label fw-semibold">Username</label>
      <input
        required
        type="text"
        name="username"
        id="username"
        minlength="8"
        class="form-control"
        placeholder="Choose a username" />
      <div class="invalid-feedback">Give a proper username (no spaces or @ allowed)</div>
    </div>

    <div class="mb-3">
      <label for="password" class="form-label fw-semibold">Password</label>
      <input
        required
        type="password"
        name="password"
        id="password"
        class="form-control"
        placeholder="Choose a strong password"
        minlength="8" />
      <div class="invalid-feedback">Minimum 8 characters required</div>
    </div>

    <div class="d-grid">
      <button type="submit" class="btn btn-primary btn-lg shadow-sm">
        Sign Up
      </button>
    </div>
  </form>

  <div class="text-center mt-3">
    <small class="text-muted">
      Already have an account?
      <a href="/login" class="text-decoration-none fw-semibold link">Login</a>
    </small>
  </div>
</div>

<script>
  window.addEventListener("load", function () {
    const loader = document.getElementById("loader");
    loader.style.transition = "opacity 0.5s ease";
    loader.style.opacity = "0";
    loader.style.zIndex = -99;
    setTimeout(() => loader.style.display = "none", 500);
  });

  // Validation patterns and form validation
  const emailPattern = /^(?!.*\.\.)(?!.*([._+-])\1)[a-zA-Z](?:[a-zA-Z0-9._+-]*[a-zA-Z0-9])?@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;
  const usernamePattern = /^[a-zA-Z][a-zA-Z0-9_]*$/;

  const form = document.getElementById("signupForm");
  const emailInput = document.getElementById("email");
  const usernameInput = document.getElementById("username");

  form.addEventListener("submit", function (event) {
    let isValid = true;

    if (!emailPattern.test(emailInput.value)) {
      emailInput.classList.add("is-invalid");
      emailInput.classList.remove("is-valid");
      isValid = false;
    } else {
      emailInput.classList.remove("is-invalid");
      emailInput.classList.add("is-valid");
    }

    if (!usernamePattern.test(usernameInput.value)) {
      usernameInput.classList.add("is-invalid");
      usernameInput.classList.remove("is-valid");
      isValid = false;
    } else {
      usernameInput.classList.remove("is-invalid");
      usernameInput.classList.add("is-valid");
    }

    if (!isValid) {
      event.preventDefault();
      event.stopPropagation();
    }
  });
</script>